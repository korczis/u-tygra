# Pivnice U Tygra - GitLab CI/CD Pipeline
# Optimized for GitLab Pages deployment

variables:
  ZOLA_VERSION: "0.19.2"

# Build with Zola and deploy to GitLab Pages
pages:
  image: alpine:3.19
  before_script:
    - apk add --no-cache wget tar
    - wget -O zola.tar.gz https://github.com/getzola/zola/releases/download/v${ZOLA_VERSION}/zola-v${ZOLA_VERSION}-x86_64-unknown-linux-musl.tar.gz
    - tar -xzf zola.tar.gz
    - chmod +x zola
    - mv zola /usr/local/bin/
  script:
    - echo "Building Pivnice U Tygra with Zola..."
    - zola --version
    - zola check
    - zola build
    - echo "Build completed successfully"
    - ls -la public/
    - echo "Site will be available at: https://nguyen43.gitlab.io/u-tygra"
  artifacts:
    paths:
      - public
    expire_in: 30 days
  rules:
    - if: $CI_COMMIT_BRANCH == "main"